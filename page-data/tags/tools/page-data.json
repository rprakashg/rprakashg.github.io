{
    "componentChunkName": "component---src-templates-tag-js",
    "path": "/tags/tools/",
    "result": {"data":{"site":{"siteMetadata":{"title":"rprakashg.github.io","author":"RAM GOPINATHAN"}},"allMarkdownRemark":{"totalCount":2,"edges":[{"node":{"excerpt":"I recently posted about a custom github action that can be leveraged to install roxctl which is a command line utility that ships with Red Hat Advanced Cluster Security for Kubernetes. If you haven'tâ€¦","html":"<p>I recently posted about a custom github action that can be leveraged to install roxctl which is a command line utility that ships with Red Hat Advanced Cluster Security for Kubernetes. If you haven't read that post I'd recommend you <a href=\"https://rprakashg.github.io/roxctl-with-github-actions-workflow/\">read</a> that first before continuing here. As a follow up to that in this post I'm going to cover two new github actions that you can use from your Github actions workflow;</p>\n<ul>\n<li><a href=\"https://github.com/rprakashg-redhat/acs-image-scan\">acs-image-scan</a></li>\n<li><a href=\"https://github.com/rprakashg-redhat/acs-image-check\">acs-image-check</a></li>\n</ul>\n<h2>acs-image-scan</h2>\n<p>This action will run a container vulnerability scan on a specified image. Action will save the scan output file and upload that as a workflow artifact. Workflow accepts bunch of input parameters which you can see in the <a href=\"https://github.com/rprakashg-redhat/acs-image-scan/blob/main/action.yaml\">action.yaml</a>.</p>\n<h3>Usage</h3>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> rprakashg<span class=\"token punctuation\">-</span>redhat/acs<span class=\"token punctuation\">-</span>image<span class=\"token punctuation\">-</span>scanl@main\n  <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># Central endpoint</span>\n    <span class=\"token key atrule\">central</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span>\n\n    <span class=\"token comment\"># ROX Api token</span>\n    <span class=\"token key atrule\">api-token</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span>\n\n    <span class=\"token comment\"># Container Image to run a vulnerability scan on</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span>\n\n    <span class=\"token comment\"># output format valid values (table|csv|json|sarif)</span>\n    <span class=\"token key atrule\">output</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span>\n\n    <span class=\"token comment\"># directory where the vulnerability scan output report should be created</span>\n    <span class=\"token key atrule\">output-path</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span></code></pre></div>\n<h3>Example workflow</h3>\n<p>Example workflow below shows how to do a container vulnerability scan using this action on a container image. This example workflow can also be found in the action repository <a href=\"https://github.com/rprakashg-redhat/acs-image-scan/blob/main/.github/workflows/example.yaml\">here</a></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">name: example\non:\n  workflow_dispatch:\njobs:\n  scan:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      - id: setup-roxctl\n        uses: rprakashg-redhat/setup-roxctl@main\n      - name: image scan help\n        run: ./roxctl image scan --help\n      - name: image scan\n        uses: ./\n        with:\n          image: \"ghcr.io/rprakashg-redhat/eventscheduler@sha256:ba9347ae0d0857ea9b11d1e7bb63e86c960cb9d670cf48330b4e22fd9fd1e4df\"\n          api-token: ${{ secrets.ROX_API_TOKEN }}\n          central: ${{ secrets.ROX_CENTRAL }}\n          output: table\n          output-path: ${{ runner.temp }}</code></pre></div>\n<h3>Scan output</h3>\n<p>Screen capture below shows output of a container vulnerability scan from github actions workflow</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/31001737c3f6d5762cd2585d395bc1ca/663b1/image-scan1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABz0lEQVQoz41S227TQBD1hyBASlKS+L6+7NrrWxw7TSh8AJVoacsL384D4REb56AZp5IRROpKRx5rd86cMzPG9+MRXdej63t0XYcvX79ByBJ+XMD0JExfYuWG/2B5xjQmGD+OP/Gr63AC8HsYcHv/hCBokagDPFHC8TJYbgLTISiYFLsKtpcy6M72NBxf879Bqvq+B53T6YRPd48wRQFVfoBIWwS6RZC2CHWLKLtmhHoHkbQQSQM/abAWBUxRwgorGJickfABC8tDnG1ghwperOGrHFag4MsMIin4a/oxrEDCjVKYImbrs5UDg0gIdIZhYIVvryzYgcLSCfghxe9sAZnXXIiKJGWDojmgaN6j3n9EkBQj4bOyZ8Lbu0e8nq+Z6MryGUS8MEfVqtgi0hXSqkW+PSCr96h2N3z3X0JSOFu5XNESEn6cIUxLVkkKw7Riy1l9jXy7HwnbG6iieSGhzBDpDZwwZRVxVnMBvdn9pVDm2wuW75/wZmGO++UEWDohE1NMhPICIbXiosJXsyX3jPpHjwjztcuWo7NlvZlY3l2wzGvz+YGTKXHtRbwWpIxUkl0aiJD5mfCFCudrjxNp10gNTZSGwpbzqeU9D2dK+AeRyf15H+rMqAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"imagescan1\"\n        title=\"imagescan1\"\n        src=\"/static/31001737c3f6d5762cd2585d395bc1ca/5a190/image-scan1.png\"\n        srcset=\"/static/31001737c3f6d5762cd2585d395bc1ca/772e8/image-scan1.png 200w,\n/static/31001737c3f6d5762cd2585d395bc1ca/e17e5/image-scan1.png 400w,\n/static/31001737c3f6d5762cd2585d395bc1ca/5a190/image-scan1.png 800w,\n/static/31001737c3f6d5762cd2585d395bc1ca/c1b63/image-scan1.png 1200w,\n/static/31001737c3f6d5762cd2585d395bc1ca/663b1/image-scan1.png 1313w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3>Workflow artifact</h3>\n<p>You can also see that the action automatically saved the output to a file and uploaded the file as workflow artifact</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cab676f769b631acb01018366076fc5f/6b26f/imagescan2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA0klEQVQoz52Ri2rEIBBF8/+/2UeymvjIGuNjxlvU4G6hlG6FgzrDPSM44VrW7lDa4DgjnA84/ImYMlKml5hKKV14dzC7Q4gZPqRGlb/KEB4hNNkZHyIf4pD/lSF07oD3J4gYmejfDGFMATFFMDOICMQXz+eLHs7fRL2eMVUZE0POG+SsoKSFEgZb5VbRfRdP3DTWVtejX+963bsw+gQlDUIIyPVnU25DmEt78c88eoVLy9nNdSElgvjcsLxLLB8S85uAEhZm3dtU8wu9f8e6qJb5AqshbuEa43f2AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"imagescan2\"\n        title=\"imagescan2\"\n        src=\"/static/cab676f769b631acb01018366076fc5f/5a190/imagescan2.png\"\n        srcset=\"/static/cab676f769b631acb01018366076fc5f/772e8/imagescan2.png 200w,\n/static/cab676f769b631acb01018366076fc5f/e17e5/imagescan2.png 400w,\n/static/cab676f769b631acb01018366076fc5f/5a190/imagescan2.png 800w,\n/static/cab676f769b631acb01018366076fc5f/c1b63/imagescan2.png 1200w,\n/static/cab676f769b631acb01018366076fc5f/29007/imagescan2.png 1600w,\n/static/cab676f769b631acb01018366076fc5f/6b26f/imagescan2.png 1658w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>acs-image-check</h2>\n<p>This action can be used to check for build time security policy violations using roxctl to ensure the container image built is compliant with all internal/external security standards defined. If you are not familar with this capability in RHACS check out <a href=\"https://docs.openshift.com/acs/4.3/operating/manage-security-policies.html\">this</a> document.</p>\n<h3>Usage</h3>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> rprakashg<span class=\"token punctuation\">-</span>redhat/acs<span class=\"token punctuation\">-</span>image<span class=\"token punctuation\">-</span>check@main\n  <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># Central endpoint</span>\n    <span class=\"token key atrule\">central</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span>\n\n    <span class=\"token comment\"># ROX Api token</span>\n    <span class=\"token key atrule\">api-token</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span>\n\n    <span class=\"token comment\"># Container Image to check for build time policy violations</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span>\n\n    <span class=\"token comment\"># output format valid values (table|csv|json|sarif)</span>\n    <span class=\"token key atrule\">output</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span>\n\n    <span class=\"token comment\"># directory to create output from image check should be created</span>\n    <span class=\"token key atrule\">output-path</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span></code></pre></div>\n<h3>Example workflow</h3>\n<p>Example workflow below shows how to run build time security policy checks on a container image using this action. Workflow can also be found in the action repo <a href=\"https://github.com/rprakashg-redhat/acs-image-check/blob/main/.github/workflows/example.yaml\">here</a></p>\n<h3>Image check output</h3>\n<p>Screen capture below shows output of build time security policy check on a container image. You can see the workflow failed because there was a high priority security issue in the image I used.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1908aa91983478742d7a6a7b952cf5a0/d073d/imagecheck1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABi0lEQVQ4y42T6W7bMBCEldgWJZISl4fOWEGKAu37P+EEs7IMBy7g/hjsekl/e1HVsv2GlBV9muFlRMgTatvj/dLi7dzg/dyo/V9Vn19/EMcryvyp0CADPrZf8DKg9YK2iy9lqT6pquvXX0he4cKg4qGMG1xc4dOq1sUFVmYVfRX9tN9hvPYDTD+jCnnRyro4acvGBbRdUt+Ggi5NKuMEts96VtugfuPj7oei9mQ8Kv6ROoCNE23Vh4KGcC8wttfKy7xBygIfMvJ0RRpWdDJgWDb9XbcdqgO02wGNF5yN06WcaotTvfuMEazWBQVIntV3fdb5XRr/byAPdqDD2XgFH0m4dVYey4KQZ40fG6b/BGx9fADuoEfLOCtN4wdCmu7x484L4M8KH4Fyr9C/Bu5tmB8gSls7GV0cFxSH9XXLnCGhTp+F6LxYMYfvpejwGSeMLfMVMOZCxuV5y+N9KRQzHstgm4QwaX1rubsVwHn2cXzeMr8UfkrMxou22zOzRb6xIwnhfKfu9lQeC/gGgCgqe66nSrMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"imagecheck1\"\n        title=\"imagecheck1\"\n        src=\"/static/1908aa91983478742d7a6a7b952cf5a0/5a190/imagecheck1.png\"\n        srcset=\"/static/1908aa91983478742d7a6a7b952cf5a0/772e8/imagecheck1.png 200w,\n/static/1908aa91983478742d7a6a7b952cf5a0/e17e5/imagecheck1.png 400w,\n/static/1908aa91983478742d7a6a7b952cf5a0/5a190/imagecheck1.png 800w,\n/static/1908aa91983478742d7a6a7b952cf5a0/c1b63/imagecheck1.png 1200w,\n/static/1908aa91983478742d7a6a7b952cf5a0/d073d/imagecheck1.png 1297w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Both actions use roxctl CLI commands to run a container vulnerability scan on the image and well as checking for build time security policy violations so roxctl needs to be installed before you can use these actions. Use <a href=\"https://github.com/rprakashg-redhat/setup-roxctl\">setup-roxctl</a> action to install roxctl from your workflow before using <code class=\"language-text\">acs-image-scan</code> and <code class=\"language-text\">acs-image-check</code> actions</p>\n<p>Lastly if you do use these actions in your workflow be sure to define repository secrets for sensitive data such as api token, central endpoint etc...</p>\n<p>Hope this helps,</p>\n<p>As always reach out to me if you have any questions about this post or how Red Hat Advanced Cluster Security for Kubernetes can help your organization.</p>\n<p>Thanks,\nRam</p>","id":"1d0cec79-f78b-5959-a755-24c13c0cc329","frontmatter":{"title":"Run container vulnerability scans and build time policy checks from Github actions workflow","date":"January, 2024","tags":["RHACS","RedHat","Developer","Tools","Github"]},"fields":{"slug":"/image-scan-check-gh-actions/"}}},{"node":{"excerpt":"If you are a kubernetes developer and you are using Github and Red Hat Advanced Cluster Security for kubernetes, you are going to find yourselves having to run roxctl from your CICD pipelines. If youâ€¦","html":"<p>If you are a kubernetes developer and you are using Github and Red Hat Advanced Cluster Security for kubernetes, you are going to find yourselves having to run roxctl from your CICD pipelines. If you are not familiar with <code class=\"language-text\">roxctl</code>, it's is a command line utility provided with Red Hat Advanced Cluster security for Kubernetes that you can use within your CICD pipelines to do things like running container vulnerability scans, container compliance checks based on system policies stored in RHACS, build time network policy generation and many other features. These tools aren't installed on github runners by default and you are going to have to download and install this yourself within your CICD pipelines. I found myself doing this over and over for various demos I worked on and decided to write a custom action to do just that.</p>\n<p><a href=\"https://github.com/rprakashg-redhat/setup-roxctl\">Here</a> is the Github repository for the setup-roxctl action.</p>\n<p>Usage</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> rprakashg<span class=\"token punctuation\">-</span>redhat/setup<span class=\"token punctuation\">-</span>roxctl@main\n  <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># Version of roxctl to be downloaded</span>\n    <span class=\"token comment\"># Default: latest</span>\n    <span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span></code></pre></div>\n<p>This action is written in typescript and will download platform specific version of the roxctl cli. Input to this action is version which is optional. If you do not specify any value the action will download the latest version of roxctl cli. Below are few sample usage Scenarios</p>\n<p>Download latest version</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> rprakashg<span class=\"token punctuation\">-</span>redhat/setup<span class=\"token punctuation\">-</span>roxctl@main\n  <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"latest\"</span></code></pre></div>\n<p>Download specific version (4.3.4)</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> rprakashg<span class=\"token punctuation\">-</span>redhat/setup<span class=\"token punctuation\">-</span>roxctl@main\n  <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"4.3.4\"</span></code></pre></div>\n<p>I've included an example workflow in the repo where you can see the action live. Below you can find the full yaml for the workflow.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> example\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">workflow_dispatch</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">inputs</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">description</span><span class=\"token punctuation\">:</span> Version of roxctl to setup\n        <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> string\n        <span class=\"token key atrule\">default</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"latest\"</span>\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">test</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v4\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> setup roxctl\n        <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> setup<span class=\"token punctuation\">-</span>roxctl\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> ./\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> inputs.version <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> verify\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n          ./roxctl version\n          ./roxctl help</span></code></pre></div>\n<p>Check out the <a href=\"https://github.com/rprakashg-redhat/setup-roxctl/actions/runs/7632384910/job/20792494029\">output</a> from the most recent run for the example to see this in a live environment</p>\n<p>Hope this helps,</p>\n<p>As always please reach out to me if you have any questions about this post via any of the contact methods listed here.</p>\n<p>Thanks,\nRam</p>","id":"3b07e5a0-dff5-56ea-a2a6-878f3df25875","frontmatter":{"title":"Running roxctl commands from github actions workflows","date":"January, 2024","tags":["RHACS","RedHat","Developer","Tools","Github"]},"fields":{"slug":"/roxctl-with-github-actions-workflow/"}}}]}},"pageContext":{"tag":"Tools"}},
    "staticQueryHashes": ["1611934721","2366241629"]}