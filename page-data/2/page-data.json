{"componentChunkName":"component---src-templates-post-list-js","path":"/2/","result":{"data":{"site":{"siteMetadata":{"title":"rprakashg.github.io","author":"RAM GOPINATHAN"}},"allMarkdownRemark":{"totalCount":38,"edges":[{"node":{"excerpt":"In this post I'm going to walk through how you can use role base access control to segregate cluster life cycle management responsibilities between dedicated teams. Few reasons you might want to doâ€¦","html":"<p>In this post I'm going to walk through how you can use role base access control to segregate cluster life cycle management responsibilities between dedicated teams. Few reasons you might want to do that are:</p>\n<ul>\n<li>Operating at scale, you have operational responsibilites for lots of clusters</li>\n<li>You might have different SLAs with internal groups who are your customers running workloads on platform</li>\n<li>Reducing the blast radius. For ex. accidently upgrading a cluster that you shouldn't have etc...</li>\n</ul>\n<p>Sample scenario I have set up is as follows. I've defined two cluster sets to group clusters provisioned for respective teams as shown in the table below</p>\n<table>\n<thead>\n<tr>\n<th>ClusterSet Name</th>\n<th>Purpose</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>digital</td>\n<td>Group all k8s clusters owned by digital group</td>\n</tr>\n<tr>\n<td>telco</td>\n<td>Group all k8s clusters owned by telco group</td>\n</tr>\n</tbody>\n</table>\n<p>I've also setup some test users in my OKTA tenant and RHACM roles they are mapped to on the HUB cluster as shown in the table below</p>\n<table>\n<thead>\n<tr>\n<th>User Name</th>\n<th>Member Of</th>\n<th>Role</th>\n<th>RHACM Role</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Mark Smith(<a href=\"mailto:msmith@acme.org\">msmith@acme.org</a>)</td>\n<td>cluster-admins</td>\n<td>Hub Cluster Admin</td>\n<td>cluster-admin, open-cluster-management:cluster-manager-admin</td>\n</tr>\n<tr>\n<td>Scott Adams (<a href=\"mailto:scott.adams@somecompany.com\">scott.adams@somecompany.com</a>)</td>\n<td>digital-ops</td>\n<td>Admin for spoke clusters owned by digital group</td>\n<td>open-cluster-management:managedclusterset:admin:digital</td>\n</tr>\n<tr>\n<td>Michael Mitchell (<a href=\"mailto:mmitch@somecompany.com\">mmitch@somecompany.com</a>)</td>\n<td>digital-dev</td>\n<td>View all spoke clusters owned by digital group</td>\n<td>open-cluster-management:managedclusterset:view:digital</td>\n</tr>\n<tr>\n<td>Nick Jonas (<a href=\"mailto:nick.jonas@somecompany.com\">nick.jonas@somecompany.com</a>)</td>\n<td>telco-ops</td>\n<td>Admin for spoke clusters owned by telco group</td>\n<td>open-cluster-management:managedclusterset:admin:telco</td>\n</tr>\n<tr>\n<td>Joe Jonas (<a href=\"mailto:joe.jonas@somecompany.com\">joe.jonas@somecompany.com</a>)</td>\n<td>telco-devs</td>\n<td>View all clusters owned by telco group</td>\n<td>open-cluster-management:managedclusterset:view:telco</td>\n</tr>\n</tbody>\n</table>\n<p>As you can see from the above table Mark smith is the super user. Scott has operational responsibilities for managing clusters owned by digital group and Nick has operational responsibilities for clusters owned by telco group.</p>\n<p>We are going to first login to RHACM hub as a super user in this scenario Mark Smith. We can see that Mark can pretty much do everything on hub</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/47eb58ad283f9e5183389c744de2a3f0/286e5/acmsuperuser.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABNklEQVR42o2QS07DMBCGcw0eEkmThm4RarsBiQMURG+AhMQhyoImTTgXl+ASIBo1bRw7dvIzY6dZsGKkT/94PC/bu7u9wWw6xWQywSURxzHG48hqGIYIgsDi+37vj+ATrMEotBpFEeU69cIwxnQ2x+p1hbf1GkmSWLJNijR1JD3pHziWZRny/B3pZoMsz+FdXc/x9PyCxnQ4mmmBg8G/reth807PAywelhBSoaoERHXAV7HHx+c3ilKgLEuKV5BSQimFhrDaNBaOS1lTXUVnBe/k7AKL+0doWsuiNalB17oCPtc0rK4liqLAfl+RXw9DGt1YeAjnDg2VNraR5ku6ENSACznpICQE8bPdYrfbWezGtJHS1NS4TXmBvuESXed+gZVdp90QN7T98dmq0cOfaaPRtu5lrL9iHb7HsC43fwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"acmsuperuser\"\n        title=\"\"\n        src=\"/static/47eb58ad283f9e5183389c744de2a3f0/5a190/acmsuperuser.png\"\n        srcset=\"/static/47eb58ad283f9e5183389c744de2a3f0/772e8/acmsuperuser.png 200w,\n/static/47eb58ad283f9e5183389c744de2a3f0/e17e5/acmsuperuser.png 400w,\n/static/47eb58ad283f9e5183389c744de2a3f0/5a190/acmsuperuser.png 800w,\n/static/47eb58ad283f9e5183389c744de2a3f0/c1b63/acmsuperuser.png 1200w,\n/static/47eb58ad283f9e5183389c744de2a3f0/29007/acmsuperuser.png 1600w,\n/static/47eb58ad283f9e5183389c744de2a3f0/286e5/acmsuperuser.png 2525w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>When Scott logs in we can see that he can only see a list of clusters that are part of clusterset digital. For demonstration purposes I've created an OpenShift cluster called <code class=\"language-text\">digitaldev</code></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0cb062eda9432765a5bf0c2e951dbfab/ba40d/digital-admin.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 24%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAz0lEQVR42oWPSwrCQBBE5yT+/4hbUdAT6DIx8b4eQRCJ4t6NRnSmpxPLaWP8LhwoqocuXtGqWaujUCxhOp3A9z14nufcx+wx/5Nkw/kcQRAgDEOo/mCEwXCM5WoNaxlEBtoYnLSF5QRJkiBN07u/9PlnJ20Yhhiq3emh0epis91BntEa54vGYn3A/mhgHJyIvoC/kowUq3K1iVKl8QSSA0ijgKy1d88VxzEuriy7JCshJneJ5DTS6xVKYAKNok0GdEEBMfPT81l2+T7Xe7H4DZ5fS7uNAZ0wAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"digitaladmin\"\n        title=\"\"\n        src=\"/static/0cb062eda9432765a5bf0c2e951dbfab/5a190/digital-admin.png\"\n        srcset=\"/static/0cb062eda9432765a5bf0c2e951dbfab/772e8/digital-admin.png 200w,\n/static/0cb062eda9432765a5bf0c2e951dbfab/e17e5/digital-admin.png 400w,\n/static/0cb062eda9432765a5bf0c2e951dbfab/5a190/digital-admin.png 800w,\n/static/0cb062eda9432765a5bf0c2e951dbfab/c1b63/digital-admin.png 1200w,\n/static/0cb062eda9432765a5bf0c2e951dbfab/29007/digital-admin.png 1600w,\n/static/0cb062eda9432765a5bf0c2e951dbfab/ba40d/digital-admin.png 2524w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Scott whose role as mentioned earlier is an admin for clusters owned by digital group he is allowed to create new cluster or import existing clusters into <code class=\"language-text\">digital</code> cluster set as shown in the screen capture above. Switching to <code class=\"language-text\">cluster sets</code> tab we can see that Scott is not allowed to create a new <code class=\"language-text\">ClusterSet</code> and its disabled as shown in screen capture below.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5c759d16d6459b008c9d3319fe151e94/ec9b3/digital-admin-clusterset.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA50lEQVR42qWPS2rDMBCGfYw8Fl3UCSRtSrvoJiEQCGSdtrlBCeQe3tjG9lVtL2xLI8l/NRKkDnRRyMDPaF6fZoLV8hlhOMd6s0UURUiS1CpBHMdI0/RfKooCWZYhz3MEu/0BL2/v+D5foLRGj/sseFq9Yjx9wPHjC1VVoSxLNE0DIkLXdU5t61XXtfXtNX8rgU4IBI+zBUYM/Dw5iDHGNfAwSYK2W0ulIEhBWc89SmmXH0rYXpYHTjxQkobpe9vghyVJaKOv5/S2JqV0/i9jsAP6kxlIDsTiIqnfeJgfxvwBby3sufz+Ab6MmBYm01JbAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"digitaladmin\"\n        title=\"\"\n        src=\"/static/5c759d16d6459b008c9d3319fe151e94/5a190/digital-admin-clusterset.png\"\n        srcset=\"/static/5c759d16d6459b008c9d3319fe151e94/772e8/digital-admin-clusterset.png 200w,\n/static/5c759d16d6459b008c9d3319fe151e94/e17e5/digital-admin-clusterset.png 400w,\n/static/5c759d16d6459b008c9d3319fe151e94/5a190/digital-admin-clusterset.png 800w,\n/static/5c759d16d6459b008c9d3319fe151e94/c1b63/digital-admin-clusterset.png 1200w,\n/static/5c759d16d6459b008c9d3319fe151e94/29007/digital-admin-clusterset.png 1600w,\n/static/5c759d16d6459b008c9d3319fe151e94/ec9b3/digital-admin-clusterset.png 2539w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Now lets login as Michael Mitchell who is a developer in digital group. As you can see from the screen capture below, Michael is only allowed to view clusters that are part of <code class=\"language-text\">digital</code> cluster set but he cannot create a new cluster or import an existing cluster.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a0399a559c484c139fa694a161bdda0b/d1442/digital-dev-view-clusters.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.500000000000004%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA80lEQVR42o2QTU7DMBCFfQ/UqqVJU1UVCxYVC3Y5QRIpcFigEhRRcZgoP1X8M3YeHrfpAljU0qcZe6z3ni2SRYzJdIY0TZFlWSDP80t/DUVRoCxLPD+VEMvVBnGyxsvuHdY5EBkYY2CtxTAMV2OtgzIWYvvwiM3dPb4O3+AlpYRSGm3boqqqULXWwcB5w5OAC/0Iz4gIhrzgbbTCzWSOj/3nRdD4oZQKsu/DvveVRY/HDl3XQXpD3jNkCZp8b7QPIiGi5RrTWYT9WXBMQ3RyZcYEPFNKhS8ZCcnOledivki8YIzXt1044GfWdf0vTdP84fedH56kkPIw7AEEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"digitaldev\"\n        title=\"\"\n        src=\"/static/a0399a559c484c139fa694a161bdda0b/5a190/digital-dev-view-clusters.png\"\n        srcset=\"/static/a0399a559c484c139fa694a161bdda0b/772e8/digital-dev-view-clusters.png 200w,\n/static/a0399a559c484c139fa694a161bdda0b/e17e5/digital-dev-view-clusters.png 400w,\n/static/a0399a559c484c139fa694a161bdda0b/5a190/digital-dev-view-clusters.png 800w,\n/static/a0399a559c484c139fa694a161bdda0b/c1b63/digital-dev-view-clusters.png 1200w,\n/static/a0399a559c484c139fa694a161bdda0b/29007/digital-dev-view-clusters.png 1600w,\n/static/a0399a559c484c139fa694a161bdda0b/d1442/digital-dev-view-clusters.png 2538w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Switching to cluster sets tab we can see that Michael can only view the clusterset but cannot create a new cluster set. This is similar to experience for Scott since he is only an admin for digital group and doesn't have permission to create new cluster set.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/43e61fd7f100d774b0893a96e4281b3a/c6162/digital-dev-view-clusterset.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA90lEQVR42pWQb26CQBDF9xBNSq3RKljUSGKbmJg2vYQ9CxxJUbEnk2/8W3bhlRnEYOsH3eSXmfB4byYjhv0BLNOC8dzFavUNz3XhnvA879zfinDeFpg6c7xYNvbBAfSk0ijLkrn3icXyE8uPL7yOZwiCHyitcTyGiOMYUsoL8ryuURQhy7J/OiHsyQzD0RgPjx2sNz5PSZKkMudQSnFtSFKJVOask7mtN71w5u+8ndHpYbvbcyBNJ1MYhmzU1QmKouDtCe6rAH3q2whzNAFhPPXgb+tA+rltSmV6cSe6LQ0l7e93MTDtOrDa0Pd35w2bMKrXuKaR7xfCi9I+wqnqOgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"digitaldev\"\n        title=\"\"\n        src=\"/static/43e61fd7f100d774b0893a96e4281b3a/5a190/digital-dev-view-clusterset.png\"\n        srcset=\"/static/43e61fd7f100d774b0893a96e4281b3a/772e8/digital-dev-view-clusterset.png 200w,\n/static/43e61fd7f100d774b0893a96e4281b3a/e17e5/digital-dev-view-clusterset.png 400w,\n/static/43e61fd7f100d774b0893a96e4281b3a/5a190/digital-dev-view-clusterset.png 800w,\n/static/43e61fd7f100d774b0893a96e4281b3a/c1b63/digital-dev-view-clusterset.png 1200w,\n/static/43e61fd7f100d774b0893a96e4281b3a/29007/digital-dev-view-clusterset.png 1600w,\n/static/43e61fd7f100d774b0893a96e4281b3a/c6162/digital-dev-view-clusterset.png 2166w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>I've created another cluster called <code class=\"language-text\">telcodev</code> for telco group. This cluster is part of telco cluster set.</p>\n<p>We can login to RHACM hub using as Nick Jonas and can see that Nick can only see clusters that are part of telco cluster set. In this scenario <code class=\"language-text\">telcodev</code> cluster deployed on AWS. Nick can also create new clusters or import clusters into the <code class=\"language-text\">telco</code> cluster set</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c39f32655a29b3a7b1d269a78ebd8ea7/52a2d/telco-ops-clusters-view.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/klEQVR42pWOy0oEMRBF8xc+QMXHaDfMKIqCO10IDXY7DTNiI7gUBP/WD3DhzlW39iupVDPXpMIIutLA4VYlN7dKTaIY8UGE8eQQSZIgTVMhc9xk2XcfuA7q75ekGfI8Rz6diqqLyyscHZ/h8ekZn02LYWDHAEMM4gX+euywADvUyek5trZHKO4fQJahDWGwBq/vDV7eGum11mBmwQ/7XVtrQWSdMtR+NMbK2gZm8zuZwBxM5EzGGGckUf+pbVt0XSd4n2zGVvB33qd29iKsrm9idlv8CCByIa72fdggbOrx70uk1wZ938siancUh8B5gar6cFQoy1L0P9R1LaFff8KIhI0ID8cAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"telco-ops-clusters-view\"\n        title=\"\"\n        src=\"/static/c39f32655a29b3a7b1d269a78ebd8ea7/5a190/telco-ops-clusters-view.png\"\n        srcset=\"/static/c39f32655a29b3a7b1d269a78ebd8ea7/772e8/telco-ops-clusters-view.png 200w,\n/static/c39f32655a29b3a7b1d269a78ebd8ea7/e17e5/telco-ops-clusters-view.png 400w,\n/static/c39f32655a29b3a7b1d269a78ebd8ea7/5a190/telco-ops-clusters-view.png 800w,\n/static/c39f32655a29b3a7b1d269a78ebd8ea7/c1b63/telco-ops-clusters-view.png 1200w,\n/static/c39f32655a29b3a7b1d269a78ebd8ea7/29007/telco-ops-clusters-view.png 1600w,\n/static/c39f32655a29b3a7b1d269a78ebd8ea7/52a2d/telco-ops-clusters-view.png 2534w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Switching to the cluster set tab we can see that Nick cannot create or delete cluster set as shown in screen capture below</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a1f16373d48689552222894587b69d95/0f7bd/telco-ops-clustersets-view.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABGklEQVR42p2QTU7DMBCFcwmkQiW6gAJJyJ8qlkhIXABUtalgjxBXpMsmuU9+bCdx8phxUtHSHZE+vTfP47Ed6yEIsQhDeJ6HkNQPBu/5PlxSx3VhO4xjcFgpMzkrrfnUy3ujKIIVRgvMb228vC7xvd1it0uQJANpmiLNMmQE+2z0ps7Sk5y99fj0DPs+wMfnF1rdQagaWmv897PuXB9nkymWqxhCVJBSoq5rtG1rlBFKoZIKRVFAkd/nhwhZQ6oG1vWNg/PpDPHmnW6oze2EEMjz3AzVJutGtMm6rjtBE01DA6/mNiYXl1jHbxQCfY+xqUfTNpT9Pr+nRd7Eephxpemgo4ErGsjP4SfvEVIc1czfnqoaflNZlsb/AMxOwrN4ugiUAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"telco-ops-clusterset-view\"\n        title=\"\"\n        src=\"/static/a1f16373d48689552222894587b69d95/5a190/telco-ops-clustersets-view.png\"\n        srcset=\"/static/a1f16373d48689552222894587b69d95/772e8/telco-ops-clustersets-view.png 200w,\n/static/a1f16373d48689552222894587b69d95/e17e5/telco-ops-clustersets-view.png 400w,\n/static/a1f16373d48689552222894587b69d95/5a190/telco-ops-clustersets-view.png 800w,\n/static/a1f16373d48689552222894587b69d95/c1b63/telco-ops-clustersets-view.png 1200w,\n/static/a1f16373d48689552222894587b69d95/29007/telco-ops-clustersets-view.png 1600w,\n/static/a1f16373d48689552222894587b69d95/0f7bd/telco-ops-clustersets-view.png 2540w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Lets now login as Joe Jonas who is a developer in the telco group, As you can see from the screen capture below Joe is only allowed to view clusters that are part of <code class=\"language-text\">telco</code> group and cannot create new clusters or import existing clusters into the hub</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/25c943d1fb6a3600ce543f8b9a067d96/fe27b/telco-dev-view.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABKElEQVR42p2Q20rDQBCG9yEsChaSmKSlpR7qrUKo4OF9bKpSm4NBBF81hBRybDbJ7+wmRS+80YGPncz8+Wd22eL6CjeWhfn8AqY5gjkaQ9d1GIRuGFAU5RdUKKranfStUn6iaTBIz86nM6iajrv7B6zXr9g4G8KBQ3ieR/hwXa/LXbevfeNSLQgC+P4bPN8Hsxa3mJ1d4v3jEyLatsF/ou1hwmxwNIS9epGNNE2RFwXi7RZhGCKOYyRJgoJqeZ6jLEtJVVXgnMtc9ArqVbsd2HhyioPDY9hPnWFFoqZpwOsadY/4UZximCTLpE4Er6nXcBpWkDkZ6uYEAzJc2s9SkJFYbPKT/XZyk559TwzIsi7nvAYzRlMyHOJxuZLrR1Ekr/lXxLOIZb4AQUqxaOq4fkAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"telco-dev-clusters-view\"\n        title=\"\"\n        src=\"/static/25c943d1fb6a3600ce543f8b9a067d96/5a190/telco-dev-view.png\"\n        srcset=\"/static/25c943d1fb6a3600ce543f8b9a067d96/772e8/telco-dev-view.png 200w,\n/static/25c943d1fb6a3600ce543f8b9a067d96/e17e5/telco-dev-view.png 400w,\n/static/25c943d1fb6a3600ce543f8b9a067d96/5a190/telco-dev-view.png 800w,\n/static/25c943d1fb6a3600ce543f8b9a067d96/c1b63/telco-dev-view.png 1200w,\n/static/25c943d1fb6a3600ce543f8b9a067d96/29007/telco-dev-view.png 1600w,\n/static/25c943d1fb6a3600ce543f8b9a067d96/fe27b/telco-dev-view.png 2532w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>In the next post I will cover how you can use RBAC to control who can create publish governance policies.</p>\n<p>Hope that helps,\nRam</p>","id":"a6577d02-fd1b-5ece-b649-1e2a2534a99b","frontmatter":{"title":"Using RBAC to segregate cluster lifecycle management responsibilities between dedicated teams","date":"April 03, 2024","tags":["containers","platform","kubernetes","openshift","redhat"],"author":"Ram Gopinathan"},"fields":{"slug":"/rbac-cluster-lifecycle-rhacm/"}}},{"node":{"excerpt":"I've done quite a bit of work on windows containers on openshift and decided to write a 4 part series to deep dive into this. So here is the break down of what will be covered. Part 1 which is thisâ€¦","html":"<p>I've done quite a bit of work on windows containers on openshift and decided to write a 4 part series to deep dive into this. So here is the break down of what will be covered.</p>\n<ul>\n<li>\n<p><a href=\"/windows-container-support-in-ocp-1\">Part 1</a> which is this post, we are going to cover how to enable windows container support and add windows nodes onto cluster. We are also going to deploy a sample application to test</p>\n</li>\n<li>\n<p><a href=\"\">Part 2</a> we are going to cover using persistent storage and go over some of the usecases and scenarios that you might run into in real world</p>\n</li>\n<li>\n<p><a href=\"\">Part 3</a> we are going to cover autoscaling windows workloads specifically custom metrics autoscaler as HPA and VPA is still not supported for windows containers yet. We are also going to cover scaling windows machineset</p>\n</li>\n<li>\n<p><a href=\"\">Part 4</a> we are going to cover monitoring and observability options for windows workloads. We will examine some of the gaps that exist today for windows workloads and some approaches to address these gaps</p>\n</li>\n</ul>\n<h3>Prerequisites</h3>\n<p>Before we can enable windows container support on the cluster we need to configure Hybrid networking. Run command below. Read more about this <a href=\"https://docs.openshift.com/container-platform/4.13/networking/ovn_kubernetes_network_provider/configuring-hybrid-networking.html\">here</a></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">oc patch networks.operator.openshift.io cluster --type=merge \\\n  -p '{\n    \"spec\":{\n      \"defaultNetwork\":{\n        \"ovnKubernetesConfig\":{\n          \"hybridOverlayConfig\":{\n            \"hybridClusterNetwork\":[\n              {\n                \"cidr\": \"10.132.0.0/14\",\n                \"hostPrefix\": 23\n              }\n            ]\n          }\n        }\n      }\n    }\n  }'</code></pre></div>\n<h3>Adding windows workers to Openshift cluster</h3>\n<p>I have automated the steps to enable windows container support and add windows worker nodes to the cluster using an Ansible playbook. Check out the full playbook <a href=\"https://github.com/rprakashg-redhat/windemos/tree/main/install\">here</a></p>\n<p>There are two parts to the paybook</p>\n<ul>\n<li>Install and configure Windows Machine Config Operator (WMCO)</li>\n</ul>\n<p>All the steps to install and configure WMCO are automated in this script <a href=\"https://github.com/rprakashg-redhat/windemos/blob/main/install/tasks/enable-wmco.yaml\">here</a>. Script is pretty self explanatory. One thing to call out is that when we create the namespace where windows machine config operator is installed, we are setting a label named <code class=\"language-text\">openshift.io/cluster-monitoring</code> to 'true', see the jinja2 template snippet below. This will tell WMCO to also install and configure prometheus windows exporter on the nodes and perform all necessary configurations to ensure openshift cluster monitoring prometheus server scrapes metrics exposed by the windows exporter.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">---\napiVersion: v1\nkind: Namespace\nmetadata:\n  name: {{ namespace }} \n  labels:\n    openshift.io/cluster-monitoring: 'true'\n...</code></pre></div>\n<ul>\n<li>Add windows worker nodes by creating a <code class=\"language-text\">Machineset</code> resource.</li>\n</ul>\n<p>All of the windows machineset creation steps are automated in this <a href=\"https://github.com/rprakashg-redhat/windemos/blob/main/install/tasks/add-windows-workers.yaml\">script</a>. Script is pretty self explanatory so I won't go into too much detail here.</p>\n<p>Before running the Ansible playbook we need to generate an ssh key for WMCO which is used to authenticate with windows nodes and perform actions like installing and configuring prometheus windows exporter etc. We can generate the ssh key by running command below</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ssh-keygen  -t ed25519 -C \"$USER@aws-win\" -f ~/.ssh/aws-win -N \"\"</code></pre></div>\n<p>Next we will base64 encode the private key and store it in an environment variable by running command below</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">export PRIVATE_KEY=$(cat $HOME/.ssh/aws-win | base64)</code></pre></div>\n<p>When we run the playbook we are going to pass specify `PRIVATE_KEY' environment variable as value for variable key which is used to create the kubernetes secret</p>\n<p>I've kicked off the playbook and it completed successfully</p>\n<p><a href=\"https://asciinema.org/a/TZpbfk56sqG23U5XDOettN74U\"><img src=\"https://asciinema.org/a/TZpbfk56sqG23U5XDOettN74U.svg\" alt=\"asciicast\"></a></p>\n<p>We can login to Openshift web console and see that windows machine config operator was installed and configured successfully as shown in screen capture below</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a6a8c1356c2e6749f882db34ed3d0404/fe83d/wmco.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABEklEQVR42pWQy0oDQRBF+xtiogazEBcuYh4aXOjCRZBkERFXIkb0AwTJ+E1qMmO+TRjM2I+Z6b5WVx4azUILDreoKqput6hX91DZqqDVvkDn5hHty3ucXj2gcz1Y0CXOboMF53cBeqTd/mB5rh9AVOv7KJTKCEdjOACxNMhI8x+4FXzv25mKo+MTbO/sIopeecwoCeeo5eyfyVKDPEt5rag1Wiiul/H0/DJdaAystbTUrQC/ch9SSsaHqNaaKBQ3MByGfgJxHCNJEiilobUmVayaVGnDdTXLue5nKJfau8wgmgeHWCttIozGfEHRJe8ypabNc/w3yGGDHY7CiAtv8Tsmkw92OWf+JD6UpktMv+jr8CcIydyx2+/rxQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"wmco\"\n        title=\"\"\n        src=\"/static/a6a8c1356c2e6749f882db34ed3d0404/5a190/wmco.png\"\n        srcset=\"/static/a6a8c1356c2e6749f882db34ed3d0404/772e8/wmco.png 200w,\n/static/a6a8c1356c2e6749f882db34ed3d0404/e17e5/wmco.png 400w,\n/static/a6a8c1356c2e6749f882db34ed3d0404/5a190/wmco.png 800w,\n/static/a6a8c1356c2e6749f882db34ed3d0404/c1b63/wmco.png 1200w,\n/static/a6a8c1356c2e6749f882db34ed3d0404/29007/wmco.png 1600w,\n/static/a6a8c1356c2e6749f882db34ed3d0404/fe83d/wmco.png 2262w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Expand <code class=\"language-text\">compute</code> option on sidebar and select <code class=\"language-text\">machineset</code> and from the screen capture below we can see the new windows machineset created.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/dd8ca4a40d0286528718a2b6c956d3b5/faa22/winmachineset.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB4UlEQVR42p2S22oTURSGByoKTW/S1EPbgIc0h5rWIkrBw4UXovgG1qSNRUWKYAu+RPWiILV9D8ULk6fxQlqaDJM579Ps+V17pw1eSgd+9s+sxbf/tWac1VoN1XoDM6USiqUZTExO40JhJOMnJou4ODU91qV//FiFIgrFKyiUZuE0l1ZQqS5ibr6MlUfP8Xavi9eff6Cz+x2bX37i3d4vfNzvYudbF9v27I3PT4cjbVNt56CHra89OPXFZVRqtzE7fx1rr9YhpYDv+0jTFOd5nGq9iVsLDVwzwNYGGGNwXRdhGCKnhjzP/wtk+owcM+6CTXgDrXbHFqUQkJyDU0pBF2iloE7fGZ9JCUE1TafxSnDkWTZKaNJZYJmArXWwWODoJARnAv2TIwwGHo3PEYcRhl4ATWAex/D6fSi6TBI4DgJkZkW5Pk1IssD2BjVI/P7j0x4T+N4AfhAhiShpwpDEKTIDSRKwKLReEYhFkfUwI9+s1GF0+WoZL9fayBRw7KaImII7dDGMGZjIIGSGhN7lWkPRmAlBjdc0KifYeIf3Vx+guXyXoA10Nt+AenDscURcI4gChJSYqxxK50iltnvS1MRpn2cfQ9IFZ955+uwFHj5+gqU79/B+64MtCKUt4Dy/zV9n2nKVVz18OAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"machineset\"\n        title=\"\"\n        src=\"/static/dd8ca4a40d0286528718a2b6c956d3b5/5a190/winmachineset.png\"\n        srcset=\"/static/dd8ca4a40d0286528718a2b6c956d3b5/772e8/winmachineset.png 200w,\n/static/dd8ca4a40d0286528718a2b6c956d3b5/e17e5/winmachineset.png 400w,\n/static/dd8ca4a40d0286528718a2b6c956d3b5/5a190/winmachineset.png 800w,\n/static/dd8ca4a40d0286528718a2b6c956d3b5/c1b63/winmachineset.png 1200w,\n/static/dd8ca4a40d0286528718a2b6c956d3b5/faa22/winmachineset.png 1509w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Select <code class=\"language-text\">Machines</code> option from the sidebar navigation and we can see that a new Machine provisioned as node</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1726eafbb773f9a229108096170c51d8/3b477/win-machines.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB3klEQVR42pVQTW/TUBD0r6CgxG5J05A4IUmhpSooTdwk4gjiH3LiT3DhBFJ7oSCQOFQCiTZp2sR+tt+n7WH9kv4AVhrNvNXT7O44O942ei0fruth65GLh50httojPPBPSI9Q6QaobmB1L4DbW7+9/QkqvTGq/QlqB1PUD1/DabSeotnpw9vexfFgjI8XM3z6ucSXywTnfxQurjS+Eb7f87XGj5mx/PWvwtlviXPC+88rfDgL4XT7B2g0O6h6NYxOp4hWt9Ayxf/Wr5nA5ULCabV7qDf8tWEwQcIldFZACAmhDEyWQymNLM+htYGQCtmmVxSAJOb0tyx6wvHp3N29FipuDcF4imXIEfICLDW4XmkwmSFOGFLOyVBblMWFsCylJFNlzfK8WG+496QNlzIM7MmMDCQSJjC/S0kLcDIUSQJNJiUyMpA8tazKQZteTsOco1dDDIan6HSf4c3bd7idLzFbxGBhjNkNA4tiJOEdYQVJpipNYARHGkWWRcyoH1ttyNxueHj0Et5O3WYYRRzzSNOJGotQIRGazkohKSdjKEtCkWdQdGrJmjYzWlldUM5O0+9i//kLyvAxBicBVmGKBaPsUoWbUIIJReYJOE03xlBOuc3uPsuyl2WZ1WWG/wArRj8bPUtVywAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"winmachines\"\n        title=\"\"\n        src=\"/static/1726eafbb773f9a229108096170c51d8/5a190/win-machines.png\"\n        srcset=\"/static/1726eafbb773f9a229108096170c51d8/772e8/win-machines.png 200w,\n/static/1726eafbb773f9a229108096170c51d8/e17e5/win-machines.png 400w,\n/static/1726eafbb773f9a229108096170c51d8/5a190/win-machines.png 800w,\n/static/1726eafbb773f9a229108096170c51d8/c1b63/win-machines.png 1200w,\n/static/1726eafbb773f9a229108096170c51d8/29007/win-machines.png 1600w,\n/static/1726eafbb773f9a229108096170c51d8/3b477/win-machines.png 1855w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Select <code class=\"language-text\">Nodes</code> option from the sidebar navigation and we can see that a new windows node is provisioned and joined to the cluster. We are only seeing one node here because in my machineset resource I specified replicas = 1 as this is just for demonstration purposes. In real world scenarios you might set it to a desired number that meets your requirements.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b2ceba5a1093bd3f13019ac616bbeb48/10a83/winnodes.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABK0lEQVR42k2P60rDQBSE8xBSr1RBRFov9YIIIv5TalGfwIr1CYQkbcWCbxzjbvaezXg2TUt/fMyZs5MhJzo67GKv3Ubn4hb3wxQPw5hIlvTfEjyPUjwRQV8+xrX2F5nXBIP3KR6JwWiK6KR3ifWNHXzGE3gAxlewpGVD2FUroFG/QrlCdEqFLSpM0wmcceC/GaxgMILDKwEnCpRSQrE/2vMlmpMvOO1zmlk9V1oh6h6fYa21hSQeg3GHLMthpYAqihpLZU4pFDl9SD5gBL1zDskYWJbVs6VdyEW98ytsbu9i+jWDpH/mUqPyJVxJOIeqmh+qta69NqZWRd5aC0kllrz3dDxlo+ubO+wfdPA9+4EKhULR47yspNIQDKWLQtMUBm9plnRBKA7ZkPsHeUuPpSFLmKYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"winnode\"\n        title=\"\"\n        src=\"/static/b2ceba5a1093bd3f13019ac616bbeb48/5a190/winnodes.png\"\n        srcset=\"/static/b2ceba5a1093bd3f13019ac616bbeb48/772e8/winnodes.png 200w,\n/static/b2ceba5a1093bd3f13019ac616bbeb48/e17e5/winnodes.png 400w,\n/static/b2ceba5a1093bd3f13019ac616bbeb48/5a190/winnodes.png 800w,\n/static/b2ceba5a1093bd3f13019ac616bbeb48/c1b63/winnodes.png 1200w,\n/static/b2ceba5a1093bd3f13019ac616bbeb48/29007/winnodes.png 1600w,\n/static/b2ceba5a1093bd3f13019ac616bbeb48/10a83/winnodes.png 2109w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>At this point cluster is ready to run windows workloads.</p>\n<h3>Deploying Windows Workloads</h3>\n<p>Runtime class simplifies use of scheduling mechanisms like taints and tolerations so your developers don't have to. I cannot tell you how many times I have had someone complain to me saying my app is not starting up and ofcourse it got scheduled to run on linux node because developer failed to set node selector labels and tolerations.</p>\n<p>We are going to create a runtime class using the yaml snippet below</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> node.k8s.io/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> RuntimeClass\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> legacywindows \n<span class=\"token key atrule\">handler</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'runhcs-wcow-process'</span>\n<span class=\"token key atrule\">scheduling</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">nodeSelector</span><span class=\"token punctuation\">:</span> \n    <span class=\"token key atrule\">kubernetes.io/os</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'windows'</span>\n    <span class=\"token key atrule\">kubernetes.io/arch</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'amd64'</span>\n    <span class=\"token key atrule\">node.kubernetes.io/windows-build</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'10.0.20348'</span>\n  <span class=\"token key atrule\">tolerations</span><span class=\"token punctuation\">:</span> \n  <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">effect</span><span class=\"token punctuation\">:</span> NoSchedule\n    <span class=\"token key atrule\">key</span><span class=\"token punctuation\">:</span> os\n    <span class=\"token key atrule\">operator</span><span class=\"token punctuation\">:</span> Equal\n    <span class=\"token key atrule\">value</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"Windows\"</span></code></pre></div>\n<p>next we are going to deploy a simple webserver using the yaml snippet below. Note the <em><code class=\"language-text\">runtimeClassName: legacywindows</code></em> this is all a developer needs to know to ensure workload always gets scheduled on windows nodes available on the cluster.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> apps/v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Deployment\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> win<span class=\"token punctuation\">-</span>webserver\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> win<span class=\"token punctuation\">-</span>webserver\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">selector</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">matchLabels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> win<span class=\"token punctuation\">-</span>webserver\n  <span class=\"token key atrule\">replicas</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span>\n  <span class=\"token key atrule\">template</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">app</span><span class=\"token punctuation\">:</span> win<span class=\"token punctuation\">-</span>webserver\n      <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> win<span class=\"token punctuation\">-</span>webserver\n    <span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">runtimeClassName</span><span class=\"token punctuation\">:</span> legacywindows\n      <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> windowswebserver\n        <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> mcr.microsoft.com/windows/servercore<span class=\"token punctuation\">:</span>ltsc2022\n        <span class=\"token key atrule\">imagePullPolicy</span><span class=\"token punctuation\">:</span> IfNotPresent\n        <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> powershell.exe\n        <span class=\"token punctuation\">-</span> <span class=\"token punctuation\">-</span>command\n        <span class=\"token punctuation\">-</span> $listener = New<span class=\"token punctuation\">-</span>Object System.Net.HttpListener; $listener.Prefixes.Add('http<span class=\"token punctuation\">:</span>//<span class=\"token important\">*:80/');</span> $listener.Start();Write<span class=\"token punctuation\">-</span>Host('Listening at http<span class=\"token punctuation\">:</span>//<span class=\"token important\">*:80/');</span> while ($listener.IsListening) <span class=\"token punctuation\">{</span> $context = $listener.GetContext(); $response = $context.Response; $content='&lt;html<span class=\"token punctuation\">></span>&lt;body<span class=\"token punctuation\">></span>&lt;H1<span class=\"token punctuation\">></span>Red Hat OpenShift + Windows Container Workloads&lt;/H1<span class=\"token punctuation\">></span>&lt;/body<span class=\"token punctuation\">></span>&lt;/html<span class=\"token punctuation\">></span>'; $buffer = <span class=\"token punctuation\">[</span>System.Text.Encoding<span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>UTF8.GetBytes($content); $response.ContentLength64 = $buffer.Length; $response.OutputStream.Write($buffer<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> $buffer.Length); $response.Close(); <span class=\"token punctuation\">}</span>;\n        <span class=\"token key atrule\">securityContext</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">runAsNonRoot</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n          <span class=\"token key atrule\">windowsOptions</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">runAsUserName</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"ContainerAdministrator\"</span></code></pre></div>\n<p>Next we are going to create a service type <code class=\"language-text\">Loadbalancer</code> and expose this service to external access as shown in command below.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">kubectl apply -f apps/service.yaml</code></pre></div>\n<p>Next we are going to get the URL for this application by running command below.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">export SERVICE_URL=$(oc get services win-webserver -o jsonpath=\"{.status.loadBalancer.ingress[0].hostname}\")</code></pre></div>\n<p>Lastly we can run a simple curl command to verify the sample windows app is successfully deploy on the cluster.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;html>&lt;body>&lt;H1>Red Hat OpenShift + Windows Container Workloads&lt;/H1>&lt;/body>&lt;/html></code></pre></div>\n<p>We can also see the sample app running from a browser as shown in screen capture below.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/70a7c0f501c42fa00b7195845bb3f8c7/0b79a/winwebserver.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAnUlEQVR42nWO2QqDMBRE/f/PM7jUCmofXKpp4hpF4mkife3AYWZgLtzAGMOyrox6REpF0w7UzZuuG2h7Re260jO91DRNTz8optkg1YL8THfW2me3GUYCIQRJkpCmKUkcI0ToDmviOOKZ57xeFVEUURQFWfZAhCFVWeJlrwsc1w9rLcG+73j8p9u23X6e5+3G9eM4WJb17n7nN97/6QvideO07CDjMwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"winwebserver\"\n        title=\"\"\n        src=\"/static/70a7c0f501c42fa00b7195845bb3f8c7/5a190/winwebserver.png\"\n        srcset=\"/static/70a7c0f501c42fa00b7195845bb3f8c7/772e8/winwebserver.png 200w,\n/static/70a7c0f501c42fa00b7195845bb3f8c7/e17e5/winwebserver.png 400w,\n/static/70a7c0f501c42fa00b7195845bb3f8c7/5a190/winwebserver.png 800w,\n/static/70a7c0f501c42fa00b7195845bb3f8c7/c1b63/winwebserver.png 1200w,\n/static/70a7c0f501c42fa00b7195845bb3f8c7/0b79a/winwebserver.png 1331w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Hope this helps,</p>\n<p>Ram</p>","id":"68f76422-48df-52dc-a5c5-94fa170e152d","frontmatter":{"title":"Deep dive into Windows Container Support in OpenShift Container Platform","date":"March 30, 2024","tags":["containers","platform","kubernetes","openshift","redhat","windows","microsoft"],"author":"Ram Gopinathan"},"fields":{"slug":"/windows-container-support-in-ocp-1/"}}},{"node":{"excerpt":"Most customers use an external system for storing user identities and groups that control level of access on applications and resources deployed within the corporate network. Openshift containerâ€¦","html":"<p>Most customers use an external system for storing user identities and groups that control level of access on applications and resources deployed within the corporate network. Openshift container platform ships with a builtin OAuth server that can be configured to integrate with external identity provider systems to authenticate users accessing the cluster and control level of access they have on the cluster with clusterroles and rolebindings.</p>\n<p>For demonstration I have provisioned an OpenShift cluster on AWS and also have a OKTA developer tenant at <code class=\"language-text\">https://dev-6782679.okta.com</code> where I have created following users and groups:</p>\n<table>\n<thead>\n<tr>\n<th>User Name</th>\n<th>Member Of</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Mark Smith  (<a href=\"mailto:msmith@acme.org\">msmith@acme.org</a>)</td>\n<td>cluster-admins</td>\n</tr>\n<tr>\n<td>Tiger Woods (<a href=\"mailto:twoods@acme.org\">twoods@acme.org</a>)</td>\n<td>teama</td>\n</tr>\n<tr>\n<td>Ram G (<a href=\"mailto:rprakashg@acme.org\">rprakashg@acme.org</a>)</td>\n<td>teamb</td>\n</tr>\n</tbody>\n</table>\n<p>Mark smith role is cluster administrator and Tiger Woods and Ram G are developers working on teama and teamb respectively. When tiger woods logs into cluster we want to restrict access to teama project/namespace and when Ram G logs into cluster we want to restrict access to teamb namespace.</p>\n<p>First thing we need to do is to configure identity provider to be able to login to OpenShift cluster with okta. I have created a new application in my OKTA tenant and have saved the <code class=\"language-text\">clientID</code> and <code class=\"language-text\">clientSecret</code> to a local file. I've also automated steps to configure identity provider using ansible. You can find the ansible script <a href=\"https://github.com/rprakashg-redhat/rbac-demos/blob/main/configure-oauth.yaml\">here</a></p>\n<p>In my ansible automation scripts I'm using a static vars yaml file to load some configuration related to identity provider</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">customRoles</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">contributor</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"contributor\"</span>\n    <span class=\"token key atrule\">assignTo</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">claim</span><span class=\"token punctuation\">:</span> teama\n        <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> teama\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">claim</span><span class=\"token punctuation\">:</span> teamb\n        <span class=\"token key atrule\">namespace</span><span class=\"token punctuation\">:</span> teamb\n<span class=\"token key atrule\">providers</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">okta</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> okta\n    <span class=\"token key atrule\">claims</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">email</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> email\n      <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> name\n      <span class=\"token key atrule\">preferredUsername</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> preferred_username\n      <span class=\"token key atrule\">groups</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> groups\n    <span class=\"token key atrule\">extraScopes</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> email\n    <span class=\"token punctuation\">-</span> profile\n    <span class=\"token punctuation\">-</span> groups\n    <span class=\"token key atrule\">issuer</span><span class=\"token punctuation\">:</span>  https<span class=\"token punctuation\">:</span>//dev<span class=\"token punctuation\">-</span>6782679.okta.com\n    <span class=\"token key atrule\">secretName</span><span class=\"token punctuation\">:</span> okta<span class=\"token punctuation\">-</span>secret\n    <span class=\"token key atrule\">adminClaim</span><span class=\"token punctuation\">:</span> cluster<span class=\"token punctuation\">-</span>admins</code></pre></div>\n<p>I'm also using another vars file loaded from directory called <code class=\"language-text\">dynamic</code> which stores okta <code class=\"language-text\">clientId</code> and <code class=\"language-text\">clientSecret</code>. we are splitting this into seperate file because we don't want to checkin this to git. I'm using a .gitignore file to tell git to ignore everything in the dynamic directory except the .gitignore file.</p>\n<p>First thing that happens when ansible playbook executes is that I load the dynamic vars and merge them as shown in the snippet below.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"> <span class=\"token key atrule\">tasks</span><span class=\"token punctuation\">:</span>\n <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> include variables\n   <span class=\"token key atrule\">include_vars</span><span class=\"token punctuation\">:</span>\n     <span class=\"token key atrule\">file</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"{{ item }}\"</span>\n     <span class=\"token key atrule\">hash_behaviour</span><span class=\"token punctuation\">:</span> merge\n   <span class=\"token key atrule\">loop</span><span class=\"token punctuation\">:</span>\n   <span class=\"token punctuation\">-</span> vars/dynamic/vars.yaml</code></pre></div>\n<p>Next we are going to create a kubernetes secret in the <code class=\"language-text\">openshift-config</code> namespace to store the <code class=\"language-text\">clientSecret</code></p>\n<p>Lastly we update the OAuth configuration to add the OKTA identity provider using the <a href=\"https://docs.ansible.com/ansible/latest/collections/kubernetes/core/k8s_module.html\"><code class=\"language-text\">kubernetes.core.k8s</code></a> module as shown in the snippet below</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> configure oauth \n  <span class=\"token key atrule\">kubernetes.core.k8s</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">state</span><span class=\"token punctuation\">:</span> present\n    <span class=\"token key atrule\">apply</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\n    <span class=\"token key atrule\">resource_definition</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"{{ lookup('template', 'templates/oauth.yaml.j2') | from_yaml }}\"</span></code></pre></div>\n<p>I've gone ahead and run the ansible playbook using command below and it completed successfully.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ansible-playbook -v configure-oauth.yaml</code></pre></div>\n<h2>Configure RBAC</h2>\n<p>When Mark logs in we want him to have cluster admin privileges. Since Openshift already ships with a cluster-admin role we just need to make sure any user with a group claim <code class=\"language-text\">cluster-admins</code> will have cluster admin privileges on the cluster. We can achieve that by creating a <code class=\"language-text\">ClusterRoleBinding</code>. I wrote a simple ansible script to automate the RBAC configurations covered in this demo. You can check out the ansible script <a href=\"https://github.com/rprakashg-redhat/rbac-demos/blob/main/configure-rbac.yaml\">here</a>. Snippet below shows cluster role binding creation to allow users with <code class=\"language-text\">cluster-admins</code> group claim cluster admin privileges.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\">kubectl create clusterrolebinding okta<span class=\"token punctuation\">-</span>cluster<span class=\"token punctuation\">-</span>admin<span class=\"token punctuation\">-</span>crb <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>dry<span class=\"token punctuation\">-</span>run=client <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>clusterrole=cluster<span class=\"token punctuation\">-</span>admin <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>group <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> providers.okta.adminClaim <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token punctuation\">-</span>o yaml <span class=\"token punctuation\">|</span> kubectl apply <span class=\"token punctuation\">-</span>f <span class=\"token punctuation\">-</span></code></pre></div>\n<p>For developers Tiger Woods and Ram G I created a custom <code class=\"language-text\">ClusterRole</code> and named it <code class=\"language-text\">Contributor</code>. You can see the entire definition <a href=\"https://github.com/rprakashg-redhat/rbac-demos/blob/main/templates/contributor.yaml\">here</a></p>\n<p>Once the <strong>contributor</strong> <code class=\"language-text\">ClusterRole</code> is created we can use a <code class=\"language-text\">RoleBinding</code> resource to lock down permissions for developers to their respective namespaces <code class=\"language-text\">teama</code> and <code class=\"language-text\">teamb</code></p>\n<p>I've defined a <a href=\"https://github.com/rprakashg-redhat/rbac-demos/blob/main/templates/rb.yaml.j2\">jinja2 template</a> that loops through a list and grants any user with group claim <code class=\"language-text\">teama</code> contributor permissions on namespace <code class=\"language-text\">teama</code> and users with group claim <code class=\"language-text\">teamb</code> gets contributor rights on namespace <code class=\"language-text\">teamb</code>. Ansible playbook reads this configuration from the static vars yaml configuration file.</p>\n<p>I've run the ansible playbook using the command below and it completed successfully.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ansible-playbook -v configure-rbac.yaml</code></pre></div>\n<p>Lets login to cluster as Mark Smith. Open a browser and navigate to openshift webconsole URL for the cluster. Screen capture below shows authentication page</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e529a1535941b4b8431a552571fd37dc/29114/ocpauth.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0UlEQVR42oVSy04iQRStAE2/eAVoYHgshO5xM2vAkdVoIh9CwicomGh0KzsTN3yAbnxtxpXzVaxknDP3lFVkcDOdnD51q6vOvffcVqP9fRwdHODo8BCj0QjD4RB7e981E/1+X/PAxHo9GGyBZ8j8ppIkQdzrIRH0yIyTr+jFsY673S5iWcfcF96xsUGSxPqMvasqlQrK5TKq1SqiKEI1EjZrolarIQhDZBwHTjaLdCYD13NRKBTwcbcCq0FW9hIPZOWC63lwXXcDR4RS6bT+lmUsTDBBqVTSd23yKKpB1et15PN5jMdjXF5e4OTkGKfzOebzGWazY5yfn+GHeKyU0tU5plIK5nK5T4IRVLPZRCqVwmKxAJ/VaoV34bW83tZrvXd9c4OCCH7b3YX/T/ue72+JbQleGcHfIvL2R8TeP9Z8lsslfBHodDraT8e0n5POitL2lmCj0YAnvk0mE7y+/sL9/QOenp/x8PiE27s7/Hx5wXQ61VXRdD04GRrBQWREnJbZ1jdDKRaLCKSFMAg0AgErp3dkxwyM+6F4F0qlrhkS95mAOspm/OyFTcQqfBFhhRwKJ25hYyaxVatWu432f0DvvojXkUnA38WCIq1Wa3P2L7M/TsAIVf9MAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ocpauth\"\n        title=\"\"\n        src=\"/static/e529a1535941b4b8431a552571fd37dc/5a190/ocpauth.png\"\n        srcset=\"/static/e529a1535941b4b8431a552571fd37dc/772e8/ocpauth.png 200w,\n/static/e529a1535941b4b8431a552571fd37dc/e17e5/ocpauth.png 400w,\n/static/e529a1535941b4b8431a552571fd37dc/5a190/ocpauth.png 800w,\n/static/e529a1535941b4b8431a552571fd37dc/c1b63/ocpauth.png 1200w,\n/static/e529a1535941b4b8431a552571fd37dc/29007/ocpauth.png 1600w,\n/static/e529a1535941b4b8431a552571fd37dc/29114/ocpauth.png 1920w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Select <code class=\"language-text\">okta</code> for login and we will be redirected to <code class=\"language-text\">Okta</code> signin page as shown in screen capture below</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/459b4d70d7e5af2240831d61537e9fd6/29114/authmsmith.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABCUlEQVR42qWRzU6DQBSF53WgIUDKSg2Pqa+iC2OAaVn7s240cWFSIzQtzB8zxxmwVRelCZ3ky80998wJlyHzeYKLyyukaYokSRCGIaIo+uXQxwfNn83geR583+9rEAT9vTiOQSilKPIctChQWFxPF0sUTrd9lmUolwuUZTnMLLn1O91V59lXNyMYOcYMdV21+Kzbf9qxQxhjGENrjapu8LXZ2TCNU34ihMAxpJSoN1u0jKPTBlJ1GPM7yLhBQokWppM/65rpgZyLPuj+aYfr2wo3dzUenptec7NJgUoKvH40eFxt8fLG8L4etEmBe3Qn7K5uZWkfSJz7D4ev+cvJQM55/5pKqbNxWd/Bzx/u/M3SNQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"oktaauth\"\n        title=\"\"\n        src=\"/static/459b4d70d7e5af2240831d61537e9fd6/5a190/authmsmith.png\"\n        srcset=\"/static/459b4d70d7e5af2240831d61537e9fd6/772e8/authmsmith.png 200w,\n/static/459b4d70d7e5af2240831d61537e9fd6/e17e5/authmsmith.png 400w,\n/static/459b4d70d7e5af2240831d61537e9fd6/5a190/authmsmith.png 800w,\n/static/459b4d70d7e5af2240831d61537e9fd6/c1b63/authmsmith.png 1200w,\n/static/459b4d70d7e5af2240831d61537e9fd6/29007/authmsmith.png 1600w,\n/static/459b4d70d7e5af2240831d61537e9fd6/29114/authmsmith.png 1920w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Type in credentials for Mark Smith and click <code class=\"language-text\">Sign In</code>. After successful authentication we are going to get redirected back to OpenShift web console and will be logged into console successfully as shown in screen capture below. We can also see that Mark has full cluster admin privileges.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/59c33c18f72de61c93f178adbae54ca5/29114/smithclusteradmin.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB70lEQVR42m1T2XKcMBDkH7IGhABJiHPB7LJ4471SKcep/P8fdVqDE1el8tA10miOnh6Ibvc7fr694df7Ox6PB67XK66322aJ8/mMZVmwnE44EXL+B+u64vz1FRfGR64osPQ9ijxHkiRI0xSpyqCUolXii8Wv5C1JNsRxjCzLkGsttipLlERkrIc1FeJUIyGaduCDw5ddgt1TKniK1f+RZGyWYcezVTlUmiGajmf4bo+mG1G3I0o/IC8sstxA0+o8wMj9r0/ePxFi1Mc5almoNB5FWUmC9T2G6YiWTcSnSzZwKIotRoprg5y2KAynsR93izTLETXtHsbWfPDS2dU9+vGIyndwVSvFfD1gmlZ03Sw+4xpYSjXt9+jqBi7ciTQrENXNIJ0Dy5CseXb0laYmAyfjGNdiGA/o+lEShTHj626CNo3kB0hBT0afBTct0tzRhoASWhvRJtwz3gMUE0NcotnQNlCURTEuUcU2cugaCgY28+GEw7xw2yMKV8O1HLEiK46oA2tPRo5fBoloMm3bHibsgG9Ky1L2opdsip2HacF0ukhBWYCjBNTQcuyg9Z/N5yyQZgaecc0ww1Yd0lAwFAsIWhoyOq6vxAVBCktm0/yM++M7/55v/BuuZLQR8N0zvwhqO69Y7z/w8nJBVbf4DZFbNGOQ7EvGAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"msmith\"\n        title=\"\"\n        src=\"/static/59c33c18f72de61c93f178adbae54ca5/5a190/smithclusteradmin.png\"\n        srcset=\"/static/59c33c18f72de61c93f178adbae54ca5/772e8/smithclusteradmin.png 200w,\n/static/59c33c18f72de61c93f178adbae54ca5/e17e5/smithclusteradmin.png 400w,\n/static/59c33c18f72de61c93f178adbae54ca5/5a190/smithclusteradmin.png 800w,\n/static/59c33c18f72de61c93f178adbae54ca5/c1b63/smithclusteradmin.png 1200w,\n/static/59c33c18f72de61c93f178adbae54ca5/29007/smithclusteradmin.png 1600w,\n/static/59c33c18f72de61c93f178adbae54ca5/29114/smithclusteradmin.png 1920w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Next we are going to login to the cluster as Tiger Woods. We are going to logout and clear browser cache and open a new browser session and navigate to openshift web console and like earlier we are going to select <code class=\"language-text\">okta</code> signin option and from the okta signin page we are going to enter credentials for Tiger Woods and sign in.</p>\n<p>We can see from the screen captures for administrator and developer perspectives that tiger woods can only see resources within the namespace <code class=\"language-text\">teama</code> because he is a member of group <code class=\"language-text\">teama</code> in okta</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/537a93f5ccbd434d88975529bb0fd929/29114/tigeradminperspective.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABe0lEQVR42p1S21aDMBDMF9RiubQQEiBAgNZWabUXTl+8/P8njbtR1Acvxz7M2ckmOzu7IIZhwPPjI16ennA+n3E8HnE6DRRPOBA/7PfYbrfo+/573N1hu7vHA73jWpGrFL0xaKxFEARYzOcIoghhGCJyMXA8fM8x+F3g+3QfQkoJFS+glUKcxBBBEEFJhflCYnLlYerNiCfw/QiTiUe5a4erqUeYYcrwPuFd+9DhHP4spLMPsdkd0a42MHWHul2hapbYHwZsbncojIUpG5iqRUExL2rorESqCihtHFJlINUb15mBsN2aHlvovERGBVlRobYrlCTSdje4WffolmvHy6qBTPMPsZFLmSEhcCPBhdx5TKRpga7pXI4LGnLNkRsZEowTDdusqGnn8i0Zqu0SWV69CfLl184pjdSQ9UwXSCjHjfjuN7DQyEVFu2Oh0aEmHvMIf4j8BMFL5+W7cVmQHMoLxZxgSYI89uhodHspBC+U4X4PAn+kkf8fFq9v8THCLMSxiQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Admin\"\n        title=\"\"\n        src=\"/static/537a93f5ccbd434d88975529bb0fd929/5a190/tigeradminperspective.png\"\n        srcset=\"/static/537a93f5ccbd434d88975529bb0fd929/772e8/tigeradminperspective.png 200w,\n/static/537a93f5ccbd434d88975529bb0fd929/e17e5/tigeradminperspective.png 400w,\n/static/537a93f5ccbd434d88975529bb0fd929/5a190/tigeradminperspective.png 800w,\n/static/537a93f5ccbd434d88975529bb0fd929/c1b63/tigeradminperspective.png 1200w,\n/static/537a93f5ccbd434d88975529bb0fd929/29007/tigeradminperspective.png 1600w,\n/static/537a93f5ccbd434d88975529bb0fd929/29114/tigeradminperspective.png 1920w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1f96ce2b34b6ccb52c06cd1157906255/29114/tigerdevperspective.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABoUlEQVR42o2S2XLbMAxF9d7UWiiKlKh9t7xKrhs5Hr8kmf7/H92CdJxp7XbahzMAQRDEBWmdz2e8v77ix9sbLpcLTqcTTi9nzNoaZszzjMPhgGmaHhjHEcfjEd+fn80Zq0gSTHWFvusQcA4pJaQQCIMAPq0Z8+D7DJzT2vcNTFvGEFBOEscQZMssg1IKFucSqUogwxi27cFxOdqixrIoIaMYZdWgLGu6SEHICEJExvJAwnOpeKBgBzEKEUL4Aay2W6GoeiRpiSyvkRcNumGDzf6A5bDFZjdhS35PsfV2xLDaGdt0A6I4Q6hJckiVGt9a7b+hps2salE0PVSa48vCMTzZ7m/+V8eDx8Wnv3AZ4X3ADKZD3ZWKc9NlGKVwGH9g4dHcSNZyvTW+jtlk77Hq+io3TorPgvdJ+mbdWdV0qNoeGc1Ux/5YsPpnQTroSzhhChZd58VJTRincOkRHgo27fAg+T7JYTeJBLvyV8m6YFG2iFRmuhT0ffTAb9yGvdD+LXa/9wtWWXXQaOmavGywWu+w20/0ZUZESQZO/y4I1X/xEwbuI0zRteYaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Dev\"\n        title=\"\"\n        src=\"/static/1f96ce2b34b6ccb52c06cd1157906255/5a190/tigerdevperspective.png\"\n        srcset=\"/static/1f96ce2b34b6ccb52c06cd1157906255/772e8/tigerdevperspective.png 200w,\n/static/1f96ce2b34b6ccb52c06cd1157906255/e17e5/tigerdevperspective.png 400w,\n/static/1f96ce2b34b6ccb52c06cd1157906255/5a190/tigerdevperspective.png 800w,\n/static/1f96ce2b34b6ccb52c06cd1157906255/c1b63/tigerdevperspective.png 1200w,\n/static/1f96ce2b34b6ccb52c06cd1157906255/29007/tigerdevperspective.png 1600w,\n/static/1f96ce2b34b6ccb52c06cd1157906255/29114/tigerdevperspective.png 1920w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Now lets clear browser cache and log back into the cluster as Ram G and examine what the experience looks like for Ram G who is a developer working with <code class=\"language-text\">Team B</code></p>\n<p>We can see from the screen captures for administrator and developer perspectives that Ram G can only see resources within the namespace <code class=\"language-text\">teamb</code> because he is a member of group <code class=\"language-text\">teamb</code> in okta</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/921ac1550039427fcb21de06cf0d51aa/29114/ramgadminperspective.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABM0lEQVR42q2R3W7CMAyF8wyDNW3StGnakvC3rUVbV+AGCWnv/0Rnjjt2gzYhwcUn29LxceyI/eGA8+mEr/MZx+MR4zhi3O+nSAzDgL7v0REcu+6K3W6HD9INnyNEZQy6EGDyHFJKpGmKTGkopShmXE9MuZQp65Ik4ZhlKWsL8qmKAqK0NWzpkKQakmjaQEYGT7OEmc0l5s/p/yQZtFSwmYbYvL2j8Su0fo02bLB56bFavzJbysNyi8p5lLaBKWrmOnfII2UNsSCjgpLcVBy9X5JBy8JAA2zVIG5RN54ao8Yh9lxyT5rKLaaaTEW7WP1OMWQYqLmkXNOA/Aa4L77upxbxZrlx/LporHJ7k9Ff8MpNu+QpcbV7zNgw3sZWLRtebnmXodIlIppWfQTC1Z5+MDwIj2+xDDELM0wWtQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"adminramg\"\n        title=\"\"\n        src=\"/static/921ac1550039427fcb21de06cf0d51aa/5a190/ramgadminperspective.png\"\n        srcset=\"/static/921ac1550039427fcb21de06cf0d51aa/772e8/ramgadminperspective.png 200w,\n/static/921ac1550039427fcb21de06cf0d51aa/e17e5/ramgadminperspective.png 400w,\n/static/921ac1550039427fcb21de06cf0d51aa/5a190/ramgadminperspective.png 800w,\n/static/921ac1550039427fcb21de06cf0d51aa/c1b63/ramgadminperspective.png 1200w,\n/static/921ac1550039427fcb21de06cf0d51aa/29007/ramgadminperspective.png 1600w,\n/static/921ac1550039427fcb21de06cf0d51aa/29114/ramgadminperspective.png 1920w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2b6f292ae581358e23655d2fe2255920/29114/ramgdevperspective.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABcElEQVR42pWS2U7DMBBF/Yxomya1HS+x4yRdw6ImEl3oSyUq/v+LLpMUgUShwMPRROPx9dyZsP3zM16OR7yeTjgcDnjabLDb77Hd7bDZbrElNpRr2hZN02C9Xl/Qtg3de6LaHVjhPJrlEtZaBKMx9w5SaWitoQgpBISUEEJCyo60j0KKPiqVQpsM3jkEghnrkBmPhKdQUqOt71FVc8zmK6zqB4RQIRTTnswFcKE+4ec4UR5WkaiyYPVDi0ACoZwjy0twSmp6INUZUuOIDNp66MxD0Fn3cCK+wCViysf0zapZDedLeF/1FwdRfMGQuBmMILUFTzVuozGG4+SCEcGq6bK3YrMARR2N4sm3xFwgL8l2XmCU8B/rWEFWO7GrgonAWDloctIhaRzRD6JsSh36vPqlQ44hxcG7tehah+ftFb9a7uiEomRytYYZk8PYvBdMafUfi/hm6H+hn2FZLXpCMcNsUWN194icOp9IRb+K+RdvG6EfqmhUB4QAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"devramg\"\n        title=\"\"\n        src=\"/static/2b6f292ae581358e23655d2fe2255920/5a190/ramgdevperspective.png\"\n        srcset=\"/static/2b6f292ae581358e23655d2fe2255920/772e8/ramgdevperspective.png 200w,\n/static/2b6f292ae581358e23655d2fe2255920/e17e5/ramgdevperspective.png 400w,\n/static/2b6f292ae581358e23655d2fe2255920/5a190/ramgdevperspective.png 800w,\n/static/2b6f292ae581358e23655d2fe2255920/c1b63/ramgdevperspective.png 1200w,\n/static/2b6f292ae581358e23655d2fe2255920/29007/ramgdevperspective.png 1600w,\n/static/2b6f292ae581358e23655d2fe2255920/29114/ramgdevperspective.png 1920w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2>Resources</h2>\n<p>If you want to learn more about oauth and identity providers in openshift check out this <a href=\"https://docs.openshift.com/container-platform/4.15/authentication/understanding-identity-provider.html\">article</a></p>\n<p>Hope this helps. Please feel free to reach out if you have any questions about this post.</p>\n<p>Thanks,\nRam</p>","id":"89cdab64-2893-5ec4-b0ea-40b82664de24","frontmatter":{"title":"Authentication and role based access control in OpenShift","date":"March 28, 2024","tags":["containers","platform","kubernetes","openshift","redhat"],"author":"Ram Gopinathan"},"fields":{"slug":"/auth-and-rbac-in-ocp/"}}}]}},"pageContext":{"limit":3,"skip":3,"numPages":15,"currentPage":2}},"staticQueryHashes":["1611934721","2366241629"],"slicesMap":{}}